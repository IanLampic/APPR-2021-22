---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Ian Lampič"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)

# Uvoz vseh potrebnih knjižnic
source("/Users/ianlampic/Desktop/APPR-2021-22/lib/libraries.r", encoding="UTF-8")
```


## Izbira teme

Osrednja tema naloge je zdravstveno stanje v Evropi. Vključuje podatke o povprečni starosti, ko se prvič pojavijo zdravstvene težave, število postelj v bolnišnicah, število nesreč, zaradi katerih je potrebno v bolnici ostati več kot 4 dni, število ljudi z boleznijo, razdeljeno po večjih skupinah bolezni, potrošnja per capita v zdravstvene namene in število prebivalcev. Vsi podatki so za države v Evropi, med leti 2011 in 2019, z izjemo podatkov potrošnje, ki pa so od leta 2017 do leta 2019.

***
## Obdelava, uvoz in čiščenje podatkov

```{r uvoz}
source("/Users/ianlampic/Desktop/APPR-2021-22/uvoz/uvoz.r", encoding="UTF-8")
```

Podatke se pridobil iz Eurostata v obliki csv in tsv, ter Wikipedije. Združil sem jih v dve tabeli, in sicer v tabelo poimenovano **Koncna** in tabelo z imenom **nesrece.prebivalstvo**. V prvi so podatki o številu ljudi z boleznimi, razdeljeno po kategorijah, vsota bolezni po letih in državah, število prebivalstva in potrosnja. Razdeljeni so po letih, državah in pa spolu. V drugi so prikazani podatki o številu nesreč, številu prebivalstva, ter povprečno leto, ko se pričenjajo pojavljati hujše zdravstvene težave, razdeljeno na povprečje moških, žensk in pa skupno. Tudi tukaj so podatki razdeljeni po letih in državah.

***

## Analiza in vizualizacija podatkov

```{r vizualizacija, results='hide'}
source("/Users/ianlampic/Desktop/APPR-2021-22/vizualizacija/vizualizacija.r", encoding="UTF-8")
```

### Število ljudi z boleznimi in število nesreč
V prvem delu sem se osredotočil na podatke o številu ljudi z boleznimi v Sloveniji in pa po Evropi. Prvi graf predstavlja bolezni, ki so razdeljene po ICD-10-CM lestvici, po Sloveniji od leta 2011 do 2019. Opazimo, da prevladujeta dve skupini; bolezni cirkulacijskega sistema označeno z **Bolz** in maligne neoplazme označeno z **Mal**. Najmanj bolezni je v povezavi z nosečnostjo, porodom in puerperijem. 

```{r graf1, echo=FALSE, fig.align='center', fig.height = 7}
graf1
```

Razmerje med številom bolezni posameznih skupin lahko lažje razberemo na naslednjem grafu, ki predstavlja delitev v letu 2016. Nekatere izmed skupin, katerih število ljudi z boleznijo, je zelo malo, so povzeti skupaj pod imenom **Drugo**.

```{r graf10, echo=FALSE, fig.align='center', fig.height = 7}
graf10
```


Tretji graf predstavlja isto delitev bolezni po državah v letu 2016. Pričakovano imajo države z več prebivalstva tudi več ljudi z določenimi boleznimi. Ugotovitve glede števila ljudi po skupinah bolezni so podobna kot zgoraj.

```{r graf2, echo=FALSE, fig.align='center', fig.height = 7}
graf2
```

Iste podatke sem upodobil na še enem, rahlo drugačnem grafu.

```{r graf5, echo=FALSE, fig.align='center', fig.height = 7}
graf5
```

Naslednji graf prikazuje število nesreč, zaradi katerih je potrebno v bolnici ostati več kot štiri dni. Izvzete so Nemčija, Španija, Velika Britanija, Italija in Evropska unija, saj so bili podatki ostalih držav, zaradi prevelike razlike v številu prebivalstva, nerazločni.

```{r graf3, echo=FALSE, fig.align='center', fig.height = 7}
graf3
```

Na petem grafu sem upodobil podatke manjkajočih držav in Evropsko unijo. Pri večini držav je graf konstanten, zanimiva pa je Nizozemska, saj v letu 2014 število nesreč zelo upade, nato pa počasi spet raste.Verjetno je to posledica obsežnega in dobro vzdrževanega cestnega omrežja. Pravtako so prometni znaki zelo jasni, zaradi česar so ceste na splošno varne za voznike.

```{r graf42, echo=FALSE, fig.align='center', fig.height = 7}
graf42
```

### Zdravstvene težave in izdatki za zdravje

V drugem delu analize sem se osredotočil na izdatke za zdravstvene namene in povprečna, ko se pričenjajo pojavljati hujše zdravstvene težave in bolezni. \\
Prvi graf predstavlja mediano izdatkov za zdravje per capita po državah (kot že zgoraj omenjeno so vzeta leta 2017,2018 in 2019). Mediane so višje pri skandinavskih državah, Luksemburgu, Belgiji, Avstriji, kar se sklada z dejstvom, da je v teh državah standard življenja med višjimi.

```{r graf6, echo=FALSE, fig.align='center', fig.height = 7}
graf6
```

Naslednji graf predstavlja povprečno starost, ko se začnejo pojavljati hujše zdravstvene težave. Zanimivo je dejstvo, da ima veliko držav z višjiim življenskim standardom, kljub temu vrednosti pod nekim povprečjem (na grafu je to 62 let). Razvidno je tudi, da Slovenija od leta 2011 do leta 2019 niti enkrat ne preseže te meje.

```{r graf7, echo=FALSE, fig.align='center', fig.height = 7}
graf7
```

Tretji graf predstavlja razmerje med izdatki za zdravje in skupnim številom ljudi z boleznimi po državah in letih. Večji kot je koeficient večji naj bi bili izdatki za zdravje povprečnega posameznika.
Izstopajo spet nekatere skandinavkse države in Luksemburg. V zgornji polovici držav pa je tudi Slovenija.

```{r graf12, echo=FALSE, fig.align='center', fig.height = 7}
graf12
```

### Zemljevid razmerij med ljudmi z boleznijo in številom prebivalstva

V zadnjem delu analize se uporabil podatke o skupnem številu ljudi z boleznimi in številom prebivalstva, ter izračunal njuno razmerje. Podatki so iz leta 2016. Temnejša barva predstavlja večjo vrednost koeficenta oziroma več ljudi z boleznimi glede na število prebivalcev. Severni del Evrope ima ponovno svetlejšo barvo, južni pa temnejšo.

```{r graf13, echo=FALSE, fig.align='center', fig.height = 7}
graf13
```


***
## Napredna analiza podatkov

```{r analiza}
source("/Users/ianlampic/Desktop/APPR-2021-22/analiza/analiza.r", encoding="UTF-8")
```

Pri napredni analizi sem se odločil raziskati podobnost med državami v številu ljudi z boleznijo, razdeljeno po skupinah bolezni. Pravtako s hiarhičnim razvrščanjem kot tudi z metodo k-ti voditeljev pridemo do rezultata, da je optimalno število skupin 2.

```{r ana1, echo=FALSE, fig.align='center'}
ana1
```

```{r ana2, echo=FALSE, fig.align='center'}
ana2
```

To je prikazano na naslednjem grafu.

```{r ana3, echo=FALSE, fig.align='center'}
ana3
```

V nadaljevanju sem to predstavil še na zemljevidu Evrope.

```{r ana4, echo=FALSE, fig.align='center'}
ana4
```

V naslednjem delu sem preveril povezanost med številom ljudi z boleznijo in izdatki za zdravje per capita. Uporabil sem linearno regresijo z metodo najmanjših kvadratov.

```{r ana5, echo=FALSE, fig.align='center'}
ana5
```

Na koncu se poskusil napovedati povprečno starost pojavitve hujših zdravstvenih težav v Sloveniji. Zanimivo je to, da so napovedane vrednosti vse enake. Razlog je verjetno v tem, da je premalo podatkov in ni možno razbrati vzorca. Verjetno zato tudi vzame povprečno vrednost prejšnjih let.

```{r ana7, echo=FALSE, fig.align='center'}
ana7
```



***

```{r shiny}
#shinyAppDir("shiny", options=list(width="100%", height=600))
```


